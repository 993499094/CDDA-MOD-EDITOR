/*! For license information please see index.js.LICENSE.txt */
!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],n);else{var e="object"==typeof exports?n(require("blockly/core")):n(t.Blockly);for(var i in e)("object"==typeof exports?exports:t)[i]=e[i]}}(this,(t=>(()=>{"use strict";var n={573:n=>{n.exports=t}},e={};function i(t){var s=e[t];if(void 0!==s)return s.exports;var o=e[t]={exports:{}};return n[t](o,o.exports,i),o.exports}i.d=(t,n)=>{for(var e in n)i.o(n,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},i.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};return(()=>{i.r(s),i.d(s,{overrideOldBlockDefinitions:()=>e});var t=i(573);t.InsertionMarkerManager.prototype.update=function(n,e){var i=this.getCandidate(n);this.wouldDeleteBlock=this.shouldDelete(!!i,e),(this.wouldDeleteBlock||this.shouldUpdatePreviews(i,n))&&(i&&i.closest&&i.closest.sourceBlock_.onPendingConnection&&(i.closest.sourceBlock_.onPendingConnection(i.closest),this.pendingBlocks||(this.pendingBlocks=new Set),this.pendingBlocks.add(i.closest.sourceBlock_)),t.Events.disable(),this.maybeHidePreview(i),this.maybeShowPreview(i),t.Events.enable())};var n=t.InsertionMarkerManager.prototype.dispose;t.InsertionMarkerManager.prototype.dispose=function(){this.pendingBlocks&&this.pendingBlocks.forEach((function(t){t.finalizeConnections&&t.finalizeConnections()})),n.call(this)},t.Blocks.dynamic_if={inputCounter:1,minInputs:1,init:function(){this.setHelpUrl(t.Msg.CONTROLS_IF_HELPURL),this.setStyle("logic_blocks"),this.appendValueInput("IF0").setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_IF,"if"),this.appendStatementInput("DO0").appendField(t.Msg.CONTROLS_IF_MSG_THEN),this.setNextStatement(!0),this.setPreviousStatement(!0),this.setTooltip(t.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),e=this.inputList.filter((function(t){return t.name.includes("IF")})).map((function(t){return t.name.replace("IF","")})).join(",");n.setAttribute("inputs",e);var i=!!this.getInput("ELSE");return n.setAttribute("else",i),n.setAttribute("next",this.inputCounter),n},domToMutation:function(t){t.getAttribute("inputs")?this.deserializeInputs_(t):this.deserializeCounts_(t)},deserializeInputs_:function(n){var e=n.getAttribute("inputs");if(e){var i=e.split(",");this.getInput("IF0")&&this.removeInput("IF0"),this.getInput("DO0")&&this.removeInput("DO0");var s=i[0];this.appendValueInput("IF"+s).setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_IF,"if"),this.appendStatementInput("DO"+s).appendField(t.Msg.CONTROLS_IF_MSG_THEN);for(var o=1;o<i.length;o++)this.appendValueInput("IF"+i[o]).setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_ELSEIF,"elseif"),this.appendStatementInput("DO"+i[o]).appendField(t.Msg.CONTROLS_IF_MSG_THEN)}"true"==n.getAttribute("else")&&this.appendStatementInput("ELSE").appendField(t.Msg.CONTROLS_IF_MSG_ELSE,"else");var u=parseInt(n.getAttribute("next"));this.inputCounter=u},deserializeCounts_:function(n){for(var e=parseInt(n.getAttribute("elseif"),10)||0,i=parseInt(n.getAttribute("else"),10)||0,s=1;s<=e;s++)this.appendValueInput("IF"+s).setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+s).appendField(t.Msg.CONTROLS_IF_MSG_THEN);i&&this.appendStatementInput("ELSE").appendField(t.Msg.CONTROLS_IF_MSG_ELSE),this.inputCounter=e+1},findInputIndexForConnection:function(t){for(var n=0;n<this.inputList.length;n++)if(this.inputList[n].connection==t)return n;return null},insertElseIf:function(n){var e=this.inputCounter;this.appendValueInput("IF"+e).setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_ELSEIF,"elseif"),this.appendStatementInput("DO"+e).appendField(t.Msg.CONTROLS_IF_MSG_THEN),this.moveInputBefore("IF"+e,this.inputList[n].name),this.moveInputBefore("DO"+e,this.inputList[n+1].name),this.inputCounter++},onPendingConnection:function(n){n.type!==t.NEXT_STATEMENT||this.getInput("ELSE")||this.appendStatementInput("ELSE").appendField(t.Msg.CONTROLS_IF_MSG_ELSE,"else");var e=this.findInputIndexForConnection(n);if(null!==e){var i=this.inputList[e];if(n.targetConnection&&i.name.includes("IF")){var s=this.inputList[e+2];if(s&&"ELSE"!=s.name){var o=s&&s.connection.targetConnection;o&&!o.sourceBlock_.isInsertionMarker()&&this.insertElseIf(e+2)}else this.insertElseIf(e+2)}}},finalizeConnections:function(){for(var n=this,e=[],i=2;i<this.inputList.length-1;i+=2){var s=this.inputList[i],o=this.inputList[i+1];s.connection.targetConnection||o.connection.targetConnection||(e.push(s.name),e.push(o.name))}e.forEach((function(t){return n.removeInput(t)}));var u=this.getInput("ELSE");if(u&&!u.connection.targetConnection&&this.removeInput(u.name),this.inputList.length>2){var r=this.inputList[0],p=this.inputList[1],a=this.inputList[2];!a.name.includes("IF")||r.connection.targetConnection||p.connection.targetConnection||(this.removeInput(r.name),this.removeInput(p.name),a.removeField("elseif"),a.appendField(t.Msg.CONTROLS_IF_MSG_IF,"if"))}}},t.Blocks.dynamic_text_join={inputCounter:2,minInputs:2,init:function(){this.setHelpUrl(t.Msg.TEXT_JOIN_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("ADD0").appendField(t.Msg.TEXT_JOIN_TITLE_CREATEWITH),this.appendValueInput("ADD1"),this.setOutput(!0,"String"),this.setTooltip(t.Msg.TEXT_JOIN_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),e=this.inputList.map((function(t){return t.name})).join(",");return n.setAttribute("inputs",e),n.setAttribute("next",this.inputCounter),n},domToMutation:function(t){t.getAttribute("inputs")?this.deserializeInputs_(t):this.deserializeCounts_(t)},deserializeInputs_:function(n){var e=this,i=n.getAttribute("inputs");if(i){var s=i.split(",");this.inputList=[],s.forEach((function(t){return e.appendValueInput(t)})),this.inputList[0].appendField(t.Msg.TEXT_JOIN_TITLE_CREATEWITH)}var o=parseInt(n.getAttribute("next"));this.inputCounter=o},deserializeCounts_:function(t){for(var n=Math.max(parseInt(t.getAttribute("items"),10),this.minInputs),e=this.minInputs;e<n;e++)this.appendValueInput("ADD"+e);this.inputCounter=n},getIndexForNewInput:function(t){if(!t.targetConnection)return null;for(var n,e=0;e<this.inputList.length;e++)this.inputList[e].connection==t&&(n=e);if(n==this.inputList.length-1)return this.inputList.length+1;var i=this.inputList[n+1],s=i&&i.connection.targetConnection;return s&&!s.sourceBlock_.isInsertionMarker()?n+1:null},onPendingConnection:function(t){var n=this.getIndexForNewInput(t);null!=n&&(this.appendValueInput("ADD"+this.inputCounter++),this.moveNumberedInputBefore(this.inputList.length-1,n))},finalizeConnections:function(){var n=this;if(this.inputList.length>this.minInputs){var e=[];this.inputList.forEach((function(t){t.connection.targetConnection||e.push(t.name)})),this.inputList.length-e.length<this.minInputs&&(e=e.slice(this.minInputs)),e.forEach((function(t){return n.removeInput(t)})),0==this.inputList[0].fieldRow.length&&this.inputList[0].appendField(t.Msg.TEXT_JOIN_TITLE_CREATEWITH)}}},t.Blocks.dynamic_list_create={inputCounter:2,minInputs:2,init:function(){this.setHelpUrl(t.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("ADD0").appendField(t.Msg.LISTS_CREATE_WITH_INPUT_WITH),this.appendValueInput("ADD1"),this.setOutput(!0,"Array"),this.setTooltip(t.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),e=this.inputList.map((function(t){return t.name})).join(",");return n.setAttribute("inputs",e),n.setAttribute("next",this.inputCounter),n},domToMutation:function(t){t.getAttribute("inputs")?this.deserializeInputs_(t):this.deserializeCounts_(t)},deserializeInputs_:function(n){var e=this,i=n.getAttribute("inputs");if(i){var s=i.split(",");this.inputList=[],s.forEach((function(t){return e.appendValueInput(t)})),this.inputList[0].appendField(t.Msg.LISTS_CREATE_WITH_INPUT_WITH)}var o=parseInt(n.getAttribute("next"));this.inputCounter=o},deserializeCounts_:function(t){for(var n=Math.max(parseInt(t.getAttribute("items"),10),this.minInputs),e=this.minInputs;e<n;e++)this.appendValueInput("ADD"+e);this.inputCounter=n},getIndexForNewInput:function(t){if(!t.targetConnection)return null;for(var n,e=0;e<this.inputList.length;e++)this.inputList[e].connection==t&&(n=e);if(n==this.inputList.length-1)return this.inputList.length+1;var i=this.inputList[n+1],s=i&&i.connection.targetConnection;return s&&!s.sourceBlock_.isInsertionMarker()?n+1:null},onPendingConnection:function(t){var n=this.getIndexForNewInput(t);null!=n&&(this.appendValueInput("ADD"+this.inputCounter++),this.moveNumberedInputBefore(this.inputList.length-1,n))},finalizeConnections:function(){var n=this;if(this.inputList.length>this.minInputs){var e=[];this.inputList.forEach((function(t){t.connection.targetConnection||e.push(t.name)})),this.inputList.length-e.length<this.minInputs&&(e=e.slice(this.minInputs)),e.forEach((function(t){return n.removeInput(t)})),0==this.inputList[0].fieldRow.length&&this.inputList[0].appendField(t.Msg.LISTS_CREATE_WITH_INPUT_WITH)}}};var e=function(){t.Blocks.lists_create_with=t.Blocks.dynamic_list_create,t.Blocks.text_join=t.Blocks.dynamic_text_join,t.Blocks.controls_if=t.Blocks.dynamic_if}})(),s})()));
//# sourceMappingURL=index.js.map