/*! For license information please see index.js.LICENSE.txt */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],e);else{var o="object"==typeof exports?e(require("blockly/core")):e(t.Blockly);for(var r in o)("object"==typeof exports?exports:t)[r]=o[r]}}(this,(t=>(()=>{"use strict";var e={573:e=>{e.exports=t}},o={};function r(t){var n=o[t];if(void 0!==n)return n.exports;var i=o[t]={exports:{}};return e[t](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{r.r(n),r.d(n,{EdgeScrollOptions:()=>{},ScrollBlockDragger:()=>j,ScrollMetricsManager:()=>f,ScrollOptions:()=>P});var t=r(573),e=r.n(t);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var r=a(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:o):n.value}},l.apply(this,arguments)}function a(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function s(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(f,t);var e,o,r,n,a=(r=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(r);if(n){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return s(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=a.call(this,t)).useCachedContentMetrics=!1,e.contentMetrics=null,e}return e=f,(o=[{key:"getContentMetrics",value:function(){return this.useCachedContentMetrics&&this.contentMetrics||(this.contentMetrics=l(u(f.prototype),"getContentMetrics",this).call(this)),this.contentMetrics}}])&&i(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),f}(t.MetricsManager),p=function(t){var e=t.getBlockDragSurface();if(e)return e.getWsTranslation();var o=t.svgBlockCanvas_.getAttribute("transform").split(","),r=Number(o[0].split("(")[1]),n=Number(o[1].split(")")[0]);return new Blockly.utils.Coordinate(r,n)};function h(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var y=function(){function e(o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.workspace_=o,this.activeScrollVector_=new t.utils.Coordinate(0,0),this.animationFrameId_=0,this.lastTime_=Date.now(),this.shouldAnimate_=!1}var o,r;return o=e,(r=[{key:"stopAndDestroy",value:function(){this.activeScrollVector_=new t.utils.Coordinate(0,0),this.shouldAnimate_=!1,cancelAnimationFrame(this.animationFrameId_),this.animationFrameId_=0}},{key:"nextAnimationStep_",value:function(t){var e=this;if(this.shouldAnimate_){var o=t-this.lastTime_;this.lastTime_=t,o>0&&this.scrollTick_(o),this.animationFrameId_=requestAnimationFrame((function(t){return e.nextAnimationStep_(t)}))}}},{key:"scrollTick_",value:function(t){var e=this.activeScrollVector_.x*t,o=this.activeScrollVector_.y*t;this.scrollWorkspaceWithBlock(e,o)}},{key:"scrollWorkspaceWithBlock",value:function(t,e){var o=p(this.workspace_),r=this.workspace_.getMetricsManager();r.useCachedContentMetrics=!0;var n=this.workspace_.scrollX+t,i=this.workspace_.scrollY+e;this.workspace_.scroll(n,i),r.useCachedContentMetrics=!1;var l=p(this.workspace_),a=l.x-o.x,c=l.y-o.y;(a||c)&&this.workspace_.currentGesture_.getCurrentDragger().moveBlockWhileDragging(a,c)}},{key:"updateProperties",value:function(t){this.activeScrollVector_=t,this.shouldAnimate_=!0,0==this.animationFrameId_&&(this.lastTime_=Date.now(),this.nextAnimationStep_(this.lastTime_))}}])&&h(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),e}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function g(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function v(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?g(Object(o),!0).forEach((function(e){b(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):g(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function b(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _(t,e){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function(t,e){if(t){if("string"==typeof t)return w(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?w(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return l=t.done,t},e:function(t){a=!0,i=t},f:function(){try{l||null==o.return||o.return()}finally{if(a)throw i}}}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=new Array(e);o<e;o++)r[o]=t[o];return r}function m(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(){return k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,o){var r=S(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:o):n.value}},k.apply(this,arguments)}function S(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=D(t)););return t}function O(t,e){return O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},O(t,e)}function C(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function D(t){return D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},D(t)}var M={slowBlockSpeed:.28,fastBlockSpeed:1.4,slowBlockStartDistance:0,fastBlockStartDistance:50,oversizeBlockThreshold:.85,oversizeBlockMargin:15,slowMouseSpeed:.5,fastMouseSpeed:1.6,slowMouseStartDistance:0,fastMouseStartDistance:35},j=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}(a,e);var o,r,n,i,l=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=D(n);if(i){var o=D(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return C(this,t)});function a(e,o){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=l.call(this,e,o)).scrollDelta_=new t.utils.Coordinate(0,0),r.dragDelta_=new t.utils.Coordinate(0,0),r.scrollDirections_=["top","bottom","left","right"],r}return o=a,(r=[{key:"moveBlockWhileDragging",value:function(e,o){this.scrollDelta_.x-=e,this.scrollDelta_.y-=o;var r=t.utils.Coordinate.sum(this.scrollDelta_,this.dragDelta_),n=this.pixelsToWorkspaceUnits_(r),i=t.utils.Coordinate.sum(this.startXY_,n);this.draggingBlock_.moveDuringDrag(i),this.dragIcons_(r),this.draggedConnectionManager_.update(new t.utils.Coordinate(r.x/this.workspace_.scale,r.y/this.workspace_.scale),null)}},{key:"startDrag",value:function(e,o){var r=t.utils.Coordinate.sum(this.scrollDelta_,e);k(D(a.prototype),"startDrag",this).call(this,r,o),this.dragDelta_=e}},{key:"drag",value:function(e,o){var r=t.utils.Coordinate.sum(this.scrollDelta_,o);k(D(a.prototype),"drag",this).call(this,e,r),this.dragDelta_=o,a.edgeScrollEnabled&&this.scrollWorkspaceWhileDragging_(e)}},{key:"endDrag",value:function(t,e){k(D(a.prototype),"endDrag",this).call(this,t,e),this.stopAutoScrolling()}},{key:"getNewLocationAfterDrag_",value:function(e){var o={},r=t.utils.Coordinate.sum(this.scrollDelta_,e);return o.delta=this.pixelsToWorkspaceUnits_(r),o.newLocation=t.utils.Coordinate.sum(this.startXY_,o.delta),o}},{key:"scrollWorkspaceWhileDragging_",value:function(e){this.SCROLL_DIRECTION_VECTORS_={top:new t.utils.Coordinate(0,1),bottom:new t.utils.Coordinate(0,-1),left:new t.utils.Coordinate(1,0),right:new t.utils.Coordinate(-1,0)};var o=t.utils.svgMath.screenToWsCoordinates(this.workspace_,new t.utils.Coordinate(e.clientX,e.clientY)),r={top:[],bottom:[],left:[],right:[]},n=this.workspace_.getMetricsManager().getViewMetrics(!0);this.computeBlockCandidateScrolls_(r,n,o),this.computeMouseCandidateScrolls_(r,n,o);var i=this.getOverallScrollVector_(r);t.utils.Coordinate.equals(i,new t.utils.Coordinate(0,0))?this.stopAutoScrolling():(this.activeAutoScroll_=this.activeAutoScroll_||new y(this.workspace_),this.activeAutoScroll_.updateProperties(i))}},{key:"getOverallScrollVector_",value:function(e){var o,r=new t.utils.Coordinate(0,0),n=_(this.scrollDirections_);try{for(n.s();!(o=n.n()).done;){var i=e[o.value].reduce((function(e,o){return e&&t.utils.Coordinate.magnitude(e)>t.utils.Coordinate.magnitude(o)?e:o}),new t.utils.Coordinate(0,0));r=t.utils.Coordinate.sum(r,i)}}catch(t){n.e(t)}finally{n.f()}return r}},{key:"computeBlockCandidateScrolls_",value:function(t,e,o){var r,n=this.getBlockBoundsOverflows_(e,o),i=_(this.scrollDirections_);try{for(i.s();!(r=i.n()).done;){var l=r.value,c=n[l];if(c>a.options.slowBlockStartDistance){var s=c>a.options.fastBlockStartDistance?a.options.fastBlockSpeed:a.options.slowBlockSpeed,u=this.SCROLL_DIRECTION_VECTORS_[l].clone().scale(s);t[l].push(u)}}}catch(t){i.e(t)}finally{i.f()}}},{key:"computeMouseCandidateScrolls_",value:function(t,e,o){var r,n=this.getMouseOverflows_(e,o),i=_(this.scrollDirections_);try{for(i.s();!(r=i.n()).done;){var l=r.value,c=n[l];if(c>a.options.slowMouseStartDistance){var s=c>a.options.fastMouseStartDistance?a.options.fastMouseSpeed:a.options.slowMouseSpeed,u=this.SCROLL_DIRECTION_VECTORS_[l].clone().scale(s);t[l].push(u)}}}catch(t){i.e(t)}finally{i.f()}}},{key:"getBlockBoundsOverflows_",value:function(t,e){var o=this.draggingBlock_.getBoundingRectangle();return o.bottom-o.top>t.height*a.options.oversizeBlockThreshold&&(o.top=Math.max(o.top,e.y-a.options.oversizeBlockMargin),o.bottom=Math.min(o.bottom,e.y+a.options.oversizeBlockMargin)),o.right-o.left>t.width*a.options.oversizeBlockThreshold&&(o.left=Math.max(o.left,e.x-a.options.oversizeBlockMargin),o.right=Math.min(o.right,e.x+a.options.oversizeBlockMargin)),{top:t.top-o.top,bottom:-(t.top+t.height-o.bottom),left:t.left-o.left,right:-(t.left+t.width-o.right)}}},{key:"getMouseOverflows_",value:function(t,e){return{top:t.top-e.y,bottom:-(t.top+t.height-e.y),left:t.left-e.x,right:-(t.left+t.width-e.x)}}},{key:"stopAutoScrolling",value:function(){this.activeAutoScroll_&&this.activeAutoScroll_.stopAndDestroy(),this.activeAutoScroll_=null}}])&&m(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),a}(t.BlockDragger);function B(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}j.edgeScrollEnabled=!0,j.options=M,j.updateOptions=function(t){j.options=v(v({},j.options),t)},j.resetOptions=function(){j.options=M},t.registry.register(t.registry.Type.BLOCK_DRAGGER,"ScrollBlockDragger",j);var P=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.workspace_=e}var o,r;return o=t,r=[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enableWheelScroll:!0,enableEdgeScroll:!0,edgeScrollOptions:null},e=t.enableWheelScroll,o=void 0===e||e,r=t.enableEdgeScroll,n=void 0===r||r,i=t.edgeScrollOptions,l=void 0===i?null:i;o?this.enableWheelScroll():this.disableWheelScroll(),j.edgeScrollEnabled=n,l&&j.updateOptions(l)}},{key:"enableWheelScroll",value:function(){if(!this.wheelEvent_){var t,o=this.workspace_.getBlockDragSurface();t=o?o.getSvgRoot():this.workspace_.svgGroup_,this.wheelEvent_=e().browserEvents.conditionalBind(t,"wheel",this,this.onMouseWheel_)}}},{key:"disableWheelScroll",value:function(){this.wheelEvent_&&(e().browserEvents.unbind(this.wheelEvent_),this.wheelEvent_=null)}},{key:"enableEdgeScroll",value:function(){j.edgeScrollEnabled=!0}},{key:"disableEdgeScroll",value:function(){j.edgeScrollEnabled=!1}},{key:"updateEdgeScrollOptions",value:function(t){j.updateOptions(t)}},{key:"onMouseWheel_",value:function(t){var o=this.workspace_.options.moveOptions&&this.workspace_.options.moveOptions.wheel,r=this.workspace_.getGesture(t);if(o&&r&&r.getCurrentDragger()instanceof e().BlockDragger){var n=e().browserEvents.getScrollDeltaPixels(t),i=this.workspace_.scrollX-n.x,l=this.workspace_.scrollY-n.y,a=p(this.workspace_);this.workspace_.getMetricsManager().useCachedContentMetrics=!0,this.workspace_.scroll(i,l),this.workspace_.getMetricsManager().useCachedContentMetrics=!1;var c=p(this.workspace_),s=c.x-a.x,u=c.y-a.y;(s||u)&&(r.getCurrentDragger().moveBlockWhileDragging(s,u),t.preventDefault())}}}],r&&B(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),t}()})(),n})()));
//# sourceMappingURL=index.js.map